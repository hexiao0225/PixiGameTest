{"version":3,"file":"rete.common.js","sources":["../src/engine/component.js","../src/control.js","../src/connection.js","../src/io.js","../src/socket.js","../src/input.js","../src/output.js","../src/node.js","../src/component.js","../src/core/events.js","../src/core/emitter.js","../src/core/validator.js","../src/core/context.js","../src/engine/events.js","../src/engine/index.js","../src/events.js","../src/view/drag.js","../src/view/zoom.js","../src/view/area.js","../src/view/control.js","../src/view/socket.js","../src/view/node.js","../src/view/connection.js","../src/view/index.js","../src/selected.js","../src/editor.js","../src/index.js"],"sourcesContent":["export class Component {\n    constructor(name) {\n        if (this.constructor === Component)\n            throw new TypeError('Can not construct abstract class.');\n        \n        this.name = name;\n        this.data = {};\n        this.engine = null;\n    }\n\n    worker() { }\n}","import { Node } from './node';\n\nexport class Control {\n\n    constructor(key) {\n        if (this.constructor === Control)\n            throw new TypeError('Can not construct abstract class');\n        if (!key)\n            throw new Error('The key parameter is missing in super() of Control ');\n\n        this.key = key;\n        this.data = {};\n        this.parent = null;\n    }\n\n    getNode() {\n        if (this.parent === null)\n            throw new Error(\"Control isn't added to Node/Input\");   \n        \n        return this.parent instanceof Node ? this.parent : this.parent.node;\n    }\n\n    getData(key) {\n        return this.getNode().data[key];\n    }\n\n    putData(key, data) {\n        this.getNode().data[key] = data;\n    }  \n}","export class Connection {\n\n    constructor(output, input) {\n        this.output = output;\n        this.input = input;\n        this.data = {};\n\n        this.input.addConnection(this);\n    }\n\n    remove() {\n        this.input.removeConnection(this);\n        this.output.removeConnection(this);\n    }\n}","import { Connection } from './connection';\n\nexport class IO {\n\n    constructor(key, name, socket, multiConns) {\n\t    this.node = null;\n        this.multipleConnections = multiConns;\n        this.connections = [];\n\t   \n        this.key = key;\n        this.name = name;\n        this.socket = socket;\n    }\n    \n    removeConnection(connection: Connection) {\n        this.connections.splice(this.connections.indexOf(connection), 1);\n    }\n\n    removeConnections() {\n        this.connections.map(connection => this.removeConnection(connection));\n    }\n}","export class Socket {\n\n    constructor(name: string, data = {}) {\n        this.name = name;\n        this.data = data;\n        this.compatible = [];\n    }\n\n    combineWith(socket: Socket) {\n        this.compatible.push(socket);\n    }\n\n    compatibleWith(socket: Socket) {\n        return this === socket || this.compatible.includes(socket);\n    }\n}","import { Connection } from './connection';\nimport { Control } from './control';\nimport { IO } from './io';\nimport { Socket } from './socket';\n\nexport class Input extends IO {\n   \n    constructor(key: string, title: string, socket: Socket, multiConns: boolean = false) {\n        super(key, title, socket, multiConns);\n        this.control = null;\n    }\n\n    hasConnection() {\n        return this.connections.length > 0;\n    }\n\n    addConnection(connection: Connection) {\n        if (!this.multipleConnections && this.hasConnection())\n            throw new Error('Multiple connections not allowed');\n        this.connections.push(connection);\n    }\n\n    addControl(control: Control) {\n        this.control = control;\n        control.parent = this;\n    }\n\n    showControl() {\n        return !this.hasConnection() && this.control !== null;\n    }\n\n    toJSON() {\n        return {\n            'connections': this.connections.map(c => {\n                return {\n                    node: c.output.node.id,\n                    output: c.output.key,\n                    data: c.data\n                };\n            })\n        };\n    }\n}","import { Connection } from './connection';\nimport { IO } from './io';\nimport { Input } from './input';\nimport { Socket } from './socket';\n\nexport class Output extends IO {\n  \n    constructor(key: string, title: string, socket: Socket, multiConns: boolean = true) {\n        super(key, title, socket, multiConns);\n    }\n    \n    hasConnection() {\n        return this.connections.length > 0;\n    }\n\n    connectTo(input: Input) {\n        if (!this.socket.compatibleWith(input.socket))\n            throw new Error('Sockets not compatible');\n        if (!input.multipleConnections && input.hasConnection())\n            throw new Error('Input already has one connection');\n        if (!this.multipleConnections && this.hasConnection())\n            throw new Error('Output already has one connection');\n\n        var connection = new Connection(this, input);\n\n        this.connections.push(connection);\n        return connection;\n    }\n\n    connectedTo(input: Input) {\n        return this.connections.some((item) => {\n            return item.input === input;\n        });\n    }\n\n    toJSON() {\n        return {\n            'connections': this.connections.map(c => {\n                return {\n                    node: c.input.node.id,\n                    input: c.input.key,\n                    data: c.data\n                }\n            })\n        };\n    }\n}","import { Control } from './control';\nimport { Input } from './input';\nimport { Output } from './output';\n\nexport class Node {\n\n    constructor(name: string) {\n        this.name = name;\n        this.id = Node.incrementId();\n        this.position = [0.0, 0.0];\n\n        this.inputs = new Map();\n        this.outputs = new Map();\n        this.controls = new Map();\n        this.data = {};\n        this.meta = {};\n    }\n\n    addControl(control: Control) {\n        control.parent = this;\n\n        this.controls.set(control.key, control);\n        return this;\n    }\n\n    removeControl(control: Control) {\n        control.parent = null;\n\n        this.controls.delete(control.key);\n    }\n\n    addInput(input: Input) {\n        if (input.node !== null)\n            throw new Error('Input has already been added to the node');\n\n        input.node = this;\n\n        this.inputs.set(input.key, input);\n        return this;\n    }\n\n    removeInput(input: Input) {\n        input.removeConnections();\n        input.node = null;\n\n        this.inputs.delete(input.key);\n    }\n\n    addOutput(output: Output) {\n        if (output.node !== null)\n            throw new Error('Output has already been added to the node');\n\n        output.node = this;\n\n        this.outputs.set(output.key, output);\n        return this;\n    }\n\n    removeOutput(output: Output) {\n        output.removeConnections();\n        output.node = null;\n\n        this.outputs.delete(output.key);\n    }\n\n    getConnections() {\n        const ios = [...this.inputs.values(), ...this.outputs.values()];\n        const connections = ios.reduce((arr, io) => {\n            return [...arr, ...io.connections];\n        }, []);\n\n        return connections;\n    }\n\n    update() {}\n\n    static incrementId() {\n        if (!this.latestId)\n            this.latestId = 1\n        else\n            this.latestId++\n        return this.latestId\n    }\n\n    static resetId() {\n        this.latestId = 0;\n    }\n\n    toJSON() {\n        return {\n            'id': this.id,\n            'data': this.data,\n            'inputs': Array.from(this.inputs).reduce((obj, [key, input]) => (obj[key] = input.toJSON(), obj), {}),\n            'outputs': Array.from(this.outputs).reduce((obj, [key, output]) => (obj[key] = output.toJSON(), obj), {}),\n            'position': this.position,\n            'name': this.name\n        }\n    }\n\n    static fromJSON(json: Object) {\n        const node = new Node(json.name);\n\n        node.id = json.id;\n        node.data = json.data;\n        node.position = json.position;\n        node.name = json.name;\n        Node.latestId = Math.max(node.id, Node.latestId);\n\n        return node;\n    }\n}\n","import { Component as ComponentWorker } from './engine/component';\nimport { Node } from './node';\n\nexport class Component extends ComponentWorker {\n    constructor(name) {\n        super(name);\n        if (this.constructor === Component)\n            throw new TypeError('Can not construct abstract class.');\n\n        this.editor = null;\n        this.data = {};\n    }\n\n    async builder() { }\n\n    async build(node: Node) {\n        await this.builder(node);\n\n        return node;\n    }\n\n    async createNode(data = {}) {\n        const node = new Node(this.name);\n        \n        node.data = data;\n        await this.build(node);\n\n        return node;\n    }\n}","export class Events {\n\n    constructor(handlers) {\n        this.handlers = {\n            warn: [console.warn],\n            error: [console.error],\n            ...handlers\n        };\n    }    \n}","import { Events } from './events';\n\nexport class Emitter {\n\n    constructor(events: Events | Emitter) {\n        this.events = events instanceof Emitter ? events.events : events.handlers;\n        this.silent = false;\n    }\n\n    on(names: string, handler: () => {}) {\n        names.split(' ').forEach(name => {\n            if (!this.events[name])\n                throw new Error(`The event ${name} does not exist`);\n            this.events[name].push(handler);\n        });\n\n        return this;\n    }\n\n    trigger(name: string, params) {\n        if (!(name in this.events))\n            throw new Error(`The event ${name} cannot be triggered`);\n\n        return this.events[name].reduce((r, e) => {\n            return (e(params) !== false) && r\n        }, true); // return false if at least one event is false        \n    }\n\n    bind(name: string) {\n        if (this.events[name])\n            throw new Error(`The event ${name} is already bound`);\n\n        this.events[name] = [];\n    }\n\n    exist(name: string) {\n        return Array.isArray(this.events[name]);\n    }\n}","export class Validator {\n\n    static isValidData(data) {\n        return typeof data.id === 'string' &&\n            this.isValidId(data.id) &&\n            data.nodes instanceof Object && !(data.nodes instanceof Array);\n    }\n\n    static isValidId(id) {\n        return /^[\\w-]{3,}@[0-9]+\\.[0-9]+\\.[0-9]+$/.test(id);\n    }\n\n    static validate(id, data) {\n        var msg = '';\n        var id1 = id.split('@');\n        var id2 = data.id.split('@');\n\n        if (!this.isValidData(data))\n            msg += 'Data is not suitable. '; \n        if (id !== data.id)\n            msg += 'IDs not equal. ';\n        if (id1[0] !== id2[0])\n            msg += 'Names don\\'t match. ';\n        if (id1[1] !== id2[1])\n            msg += 'Versions don\\'t match';\n\n        return { success: msg ==='', msg };\n    }\n}","import { Emitter } from './emitter'\nimport { Validator } from './validator'\n\nexport class Context extends Emitter {\n\n    constructor(id, events) {\n        super(events);\n\n        if (!Validator.isValidId(id))\n            throw new Error('ID should be valid to name@0.1.0 format');  \n        \n        this.id = id;\n        this.plugins = new Map();\n    }\n\n    use(plugin, options = {}) {\n        if (plugin.name && this.plugins.has(plugin.name)) throw new Error(`Plugin ${plugin.name} already in use`)\n\n        plugin.install(this, options);\n        this.plugins.set(plugin.name, options)\n    }\n}","import { Events } from '../core/events';\n\nexport class EngineEvents extends Events {\n\n    constructor() {\n        super({\n            componentregister: []\n        });\n    }    \n}","import { Component } from './component';\nimport { Context } from '../core/context';\nimport { EngineEvents } from './events';\nimport { Validator } from '../core/validator';\n\nvar State = { AVALIABLE:0, PROCESSED: 1, ABORT: 2 };\n\nexport { Component };\n\nexport class Engine extends Context {\n\n    constructor(id: string) {\n        super(id, new EngineEvents());\n\n        this.components = [];\n        this.args = [];\n        this.data = null;\n        this.state = State.AVALIABLE;\n        this.onAbort = () => { };\n    }\n\n    clone() {\n        const engine = new Engine(this.id);\n\n        this.components.map(c => engine.register(c));\n\n        return engine;\n    }\n\n    register(component: Component) {\n        this.components.push(component);\n        this.trigger('componentregister', component);\n    }\n\n    async throwError (message, data = null) {\n        await this.abort();\n        this.trigger('error', { message, data });\n        this.processDone();\n\n        return 'error';\n    }\n\n    extractInputNodes(node, nodes) {\n        return Object.keys(node.inputs).reduce((a, key) => {\n            return [...a, ...(node.inputs[key].connections || []).reduce((b, c) => [...b, nodes[c.node]], [])]\n        }, []);\n    }\n\n    detectRecursions(nodes) {\n        const nodesArr = Object.keys(nodes).map(id => nodes[id]);\n        const findSelf = (node, inputNodes) => {\n            if (inputNodes.some(n => n === node))\n                return node;\n            \n            for (var i = 0; i < inputNodes.length; i++) {\n                if (findSelf(node, this.extractInputNodes(inputNodes[i], nodes)))\n                    return node;\n            }\n\n            return null;\n        }\n\n        return nodesArr.map(node => {\n            return findSelf(node, this.extractInputNodes(node, nodes))\n        }).filter(r => r !== null);\n    }\n\n    processStart() {\n        if (this.state === State.AVALIABLE) {  \n            this.state = State.PROCESSED;\n            return true;\n        }\n\n        if (this.state === State.ABORT) {\n            return false;\n        }\n\n        console.warn(`The process is busy and has not been restarted.\n                Use abort() to force it to complete`);\n        return false;\n    }\n\n    processDone() {\n        var success = this.state !== State.ABORT;\n\n        this.state = State.AVALIABLE;\n        \n        if (!success) {\n            this.onAbort();\n            this.onAbort = () => { }\n        }    \n\n        return success;\n    }\n\n    async abort() {\n        return new Promise(ret => {\n            if (this.state === State.PROCESSED) {\n                this.state = State.ABORT;\n                this.onAbort = ret;\n            }\n            else if (this.state === State.ABORT) {\n                this.onAbort();\n                this.onAbort = ret;\n            }\n            else\n                ret();\n        });\n    }\n\n    async lock(node) {\n        return new Promise(res => {\n            node.unlockPool = node.unlockPool || [];\n            if (node.busy && !node.outputData)\n                node.unlockPool.push(res);\n            else \n                res();\n            \n            node.busy = true;\n        });    \n    }\n\n    unlock(node) {\n        node.unlockPool.forEach(a => a());\n        node.unlockPool = [];\n        node.busy = false;\n    }\n\n    async extractInputData(node) {\n        const obj = {};\n\n        for (let key of Object.keys(node.inputs)) {\n            let input = node.inputs[key];\n            var conns = input.connections;\n            let connData = await Promise.all(conns.map(async (c) => {\n                const prevNode = this.data.nodes[c.node];\n\n                let outputs = await this.processNode(prevNode);\n\n                if (!outputs) \n                    this.abort();\n                else\n                    return outputs[c.output];\n            }));\n\n            obj[key] = connData;\n        }\n\n        return obj;\n    }\n\n    async processWorker(node) {\n        var inputData = await this.extractInputData(node);\n        var component = this.components.find(c => c.name === node.name);\n        var outputData = {};\n\n        try {\n            await component.worker(node, inputData, outputData, ...this.args);\n        } catch (e) {\n            this.abort();\n            this.trigger('warn', e);\n        }\n\n        return outputData;\n    }\n\n    async processNode(node) {\n        if (this.state === State.ABORT || !node)\n            return null;\n        \n        await this.lock(node);\n\n        if (!node.outputData) {\n            node.outputData = this.processWorker(node)\n        }\n\n        this.unlock(node);\n        return node.outputData;\n    }\n\n    async forwardProcess(node) {\n        if (this.state === State.ABORT)\n            return null;\n\n        return await Promise.all(Object.keys(node.outputs).map(async (key) => {\n            const output = node.outputs[key];\n\n            return await Promise.all(output.connections.map(async (c) => {\n                const nextNode = this.data.nodes[c.node];\n\n                await this.processNode(nextNode);\n                await this.forwardProcess(nextNode);\n            }));\n        }));\n    }\n\n    copy(data) {\n        data = Object.assign({}, data);\n        data.nodes = Object.assign({}, data.nodes);\n        \n        Object.keys(data.nodes).forEach(key => {\n            data.nodes[key] = Object.assign({}, data.nodes[key])\n        });\n        return data;\n    }\n\n    async validate(data) {\n        var checking = Validator.validate(this.id, data);\n\n        if (!checking.success)\n            return await this.throwError(checking.msg);  \n        \n        var recurentNodes = this.detectRecursions(data.nodes);\n\n        if (recurentNodes.length > 0)\n            return await this.throwError('Recursion detected', recurentNodes);      \n         \n        return true;\n    }\n\n    async processStartNode(id) {\n        if (id) {\n            let startNode = this.data.nodes[id];\n\n            if (!startNode)\n                return await this.throwError('Node with such id not found');   \n            \n            await this.processNode(startNode);\n            await this.forwardProcess(startNode);\n        }\n    }\n\n    async processUnreachable() {\n        for (var i in this.data.nodes) // process nodes that have not been reached\n            if (typeof this.data.nodes[i].outputData === 'undefined') {\n                var node = this.data.nodes[i];\n\n                await this.processNode(node);\n                await this.forwardProcess(node);\n            }\n    }\n\n    async process(data: Object, startId: ?number = null, ...args) {\n        if (!this.processStart()) return;\n        if (!this.validate(data)) return;    \n        \n        this.data = this.copy(data);\n        this.args = args;\n\n        await this.processStartNode(startId);\n        await this.processUnreachable();\n        \n        return this.processDone()?'success':'aborted';\n    }\n}","import { Events } from './core/events';\n\nexport class EditorEvents extends Events {\n\n    constructor() {\n        super({\n            nodecreate: [],\n            nodecreated: [],\n            noderemove: [],\n            noderemoved: [],\n            connectioncreate: [],\n            connectioncreated: [],\n            connectionremove: [],\n            connectionremoved: [],\n            translatenode: [],\n            nodetranslate: [],\n            nodetranslated: [],\n            nodedraged: [],\n            selectnode: [],\n            nodeselect: [],\n            nodeselected: [],\n            rendernode: [],\n            rendersocket: [],\n            rendercontrol: [],\n            renderconnection: [],\n            updateconnection: [],\n            componentregister: [],\n            keydown: [],\n            keyup: [],\n            translate: [],\n            translated: [],\n            zoom: [],\n            zoomed: [],\n            click: [],\n            mousemove: [],\n            contextmenu: [],\n            import: [],\n            export: [],\n            process: []\n        });\n    }    \n}","export class Drag {\n\n    constructor(el, onTranslate = () => {}, onStart = () => {}, onDrag = () => {}) {\n        this.pointerStart = null;\n\n        this.el = el;\n        this.onTranslate = onTranslate;\n        this.onStart = onStart;\n        this.onDrag = onDrag;\n\n        this.initEvents(el);\n    }\n\n    initEvents(el) {\n        el.style.touchAction = 'none';\n\n        el.addEventListener('pointerdown', this.down.bind(this));\n        window.addEventListener('pointermove', this.move.bind(this));\n        window.addEventListener('pointerup', this.up.bind(this));\n    }\n\n    down(e) {\n        e.stopPropagation();\n        this.pointerStart = [e.pageX, e.pageY]\n\n        this.onStart(e);\n    }\n\n    move(e) {\n        if (!this.pointerStart) return;\n        e.preventDefault();\n\n        let [x, y] = [e.pageX, e.pageY]\n        let delta = [x - this.pointerStart[0], y - this.pointerStart[1]];\n        let zoom = this.el.getBoundingClientRect().width / this.el.offsetWidth;\n\n        this.onTranslate(delta[0] / zoom, delta[1] / zoom, e);\n    }\n\n    up(e) {\n        if (!this.pointerStart) return;\n        \n        this.pointerStart = null;\n        this.onDrag(e);\n    }\n}","export class Zoom {\n\n    constructor(container, el, intensity, onzoom) {\n        this.el = el;\n        this.intensity = intensity;\n        this.onzoom = onzoom;\n\n        this.distance = null;\n\n        container.addEventListener('wheel', this.wheel.bind(this));\n        container.addEventListener('touchmove', this.move.bind(this));\n        container.addEventListener('touchend', this.end.bind(this));\n        container.addEventListener('touchcancel', this.end.bind(this));\n        container.addEventListener('dblclick', this.dblclick.bind(this));\n    }\n\n    wheel(e) {\n        e.preventDefault();\n        \n        var rect = this.el.getBoundingClientRect();\n        var delta = (e.wheelDelta ? e.wheelDelta / 120 : - e.deltaY / 3) * this.intensity;\n\n        var ox = (rect.left - e.clientX) * delta;\n        var oy = (rect.top - e.clientY) * delta;\n\n        this.onzoom(delta, ox, oy, 'wheel');\n    }\n\n    touches(e) {\n        let [x1, y1] = [e.touches[0].clientX, e.touches[0].clientY];\n        let [x2, y2] = [e.touches[1].clientX, e.touches[1].clientY];\n        let distance = Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n\n        return {\n            cx: (x1 + x2)/2,\n            cy: (y1 + y2)/2,\n            distance\n        };\n    }\n\n    move(e) {\n        if (e.touches.length < 2) return;\n        \n        let rect = this.el.getBoundingClientRect();\n        let { cx, cy, distance } = this.touches(e);\n\n        if (this.distance !== null) {\n            let delta = distance / this.distance - 1;\n    \n            var ox = (rect.left - cx) * delta;\n            var oy = (rect.top - cy) * delta;\n\n            this.onzoom(delta, ox, oy, 'touch');\n        }\n        this.distance = distance;\n    }\n\n    end() {\n        this.distance = null;\n    }\n\n    dblclick(e) {\n        e.preventDefault();\n        \n        var rect = this.el.getBoundingClientRect();\n        var delta = 4 * this.intensity;\n\n        var ox = (rect.left - e.clientX) * delta;\n        var oy = (rect.top - e.clientY) * delta;\n\n        this.onzoom(delta, ox, oy, 'dblclick'); \n    }\n}","import { Drag } from './drag';\nimport { Emitter } from '../core/emitter';\nimport { Zoom } from './zoom';\n\nexport class Area extends Emitter {\n\n    constructor(container, emitter: Emitter) {\n        super(emitter);\n        \n        const el = this.el = document.createElement('div');\n\n        this.container = container;\n        this.transform = { k: 1, x: 0, y: 0 };\n        this.mouse = { x: 0, y: 0 }\n\n        el.style.transformOrigin = '0 0';\n\n        this._startPosition = null;\n        this._zoom = new Zoom(container, el, 0.1, this.onZoom.bind(this));\n        this._drag = new Drag(container, this.onTranslate.bind(this), this.onStart.bind(this));\n        this.container.addEventListener('pointermove', this.pointermove.bind(this));\n\n        this.update();\n    }\n\n    update() {\n        const t = this.transform;\n\n        this.el.style.transform = `translate(${t.x}px, ${t.y}px) scale(${t.k})`;\n    }\n\n    pointermove(e) {\n        const { clientX, clientY } = e;\n        const rect = this.el.getBoundingClientRect();\n        const x = clientX - rect.left;\n        const y = clientY - rect.top;\n        const k = this.transform.k;\n        \n        this.mouse = { x: x / k, y: y / k };\n        this.trigger('mousemove', { ...this.mouse }); // TODO rename on `pointermove`\n    }\n\n    onStart() {\n        this._startPosition = { ...this.transform };\n    }\n\n    onTranslate(dx, dy) {\n        this.translate(this._startPosition.x + dx, this._startPosition.y + dy)\n    }\n\n    onZoom(delta, ox, oy, source) {\n        this.zoom(this.transform.k * (1 + delta), ox, oy, source);\n\n        this.update();\n    }\n\n    translate(x, y) {\n        const params = { transform: this.transform, x, y };\n\n        if (!this.trigger('translate', params)) return;\n\n        this.transform.x = params.x;\n        this.transform.y = params.y;\n\n        this.update();\n        this.trigger('translated');\n    }\n\n    zoom(zoom, ox = 0, oy = 0, source) {\n        const k = this.transform.k;\n        const params = { transform: this.transform, zoom, source };\n\n        if (!this.trigger('zoom', params)) return;\n        \n        const d = (k - params.zoom) / ((k - zoom) || 1);\n\n        this.transform.k = params.zoom || 1;\n        this.transform.x += ox * d;\n        this.transform.y += oy * d;\n\n        this.update();\n        this.trigger('zoomed', { source });\n    }\n\n    appendChild(el) {\n        this.el.appendChild(el)\n    }\n\n    removeChild(el) {\n        this.el.removeChild(el)\n    }\n}","import { Emitter } from '../core/emitter';\n\nexport class Control extends Emitter {\n\n    constructor(el, control, emitter) {\n        super(emitter);\n        this.trigger('rendercontrol', { el, control });\n    }\n}","import { Emitter } from '../core/emitter';\n\nexport class Socket extends Emitter {\n\n    constructor(el, type, io, node, emitter) {\n        super(emitter);\n        this.el = el;\n        this.type = type;\n        this.io = io;\n        this.node = node;\n\n        this.trigger('rendersocket', { el, [type]: this.io, socket: io.socket });\n    }\n\n    getPosition({ position }) {\n        const el = this.el;\n\n        return [\n            position[0] + el.offsetLeft + el.offsetWidth / 2,\n            position[1] + el.offsetTop + el.offsetHeight / 2\n        ]\n    }\n}","import { Control } from '../control';\nimport { Drag } from './drag';\nimport { Emitter } from '../core/emitter';\nimport { IO } from '../io';\nimport { Control as ViewControl } from './control';\nimport { Socket as ViewSocket } from './socket';\n\nexport class Node extends Emitter {\n\n    constructor(node, component, emitter) {\n        super(emitter);\n\n        this.node = node;\n        this.component = component;\n        this.sockets = new Map();\n        this.controls = new Map();\n        this.el = document.createElement('div');\n        this.el.style.position = 'absolute';\n\n        this.el.addEventListener('contextmenu', e => this.trigger('contextmenu', { e, node: this.node }));\n\n        this._startPosition = null;\n        this._drag = new Drag(this.el, this.onTranslate.bind(this), this.onSelect.bind(this), () => {\n            this.trigger('nodedraged', node);\n        });\n\n        this.trigger('rendernode', {\n            el: this.el, \n            node, \n            component: component.data, \n            bindSocket: this.bindSocket.bind(this),\n            bindControl: this.bindControl.bind(this)\n        });\n\n        this.update();\n    }\n\n    bindSocket(el: HTMLElement, type: string, io: IO) {\n        this.sockets.set(io, new ViewSocket(el, type, io, this.node, this));\n    }\n\n    bindControl(el: HTMLElement, control: Control) {\n        this.controls.set(control, new ViewControl(el, control, this));\n    }\n\n    getSocketPosition(io) {\n        return this.sockets.get(io).getPosition(this.node);\n    }\n\n    onSelect(e) {        \n        this.onStart();\n        this.trigger('selectnode', { node: this.node, accumulate: e.ctrlKey });\n    }\n\n    onStart() {\n        this._startPosition = [...this.node.position];\n    }\n\n    onTranslate(dx, dy) {\n        this.trigger('translatenode', { node: this.node, dx, dy });\n    }\n\n    onDrag(dx, dy) {\n        const x = this._startPosition[0] + dx;\n        const y = this._startPosition[1] + dy;\n\n        this.translate(x, y);\n    }\n\n    translate(x, y) {\n        const node = this.node;\n        const params = { node, x, y };\n\n        if (!this.trigger('nodetranslate', params)) return;\n\n        const prev = [...node.position];\n\n        node.position[0] = params.x;\n        node.position[1] = params.y;\n\n        this.update();\n        this.trigger('nodetranslated', { node, prev });\n    }\n\n    update() {\n        this.el.style.transform = `translate(${this.node.position[0]}px, ${this.node.position[1]}px)`;\n    }\n\n    remove() {\n        \n    }\n}","import { Emitter } from '../core/emitter';\nimport { Node as ViewNode } from './node';\n\nexport class Connection extends Emitter {\n\n    constructor(connection, inputNode: ViewNode, outputNode: ViewNode, emitter) {\n        super(emitter);\n        this.connection = connection;\n        this.inputNode = inputNode;\n        this.outputNode = outputNode;\n\n        this.el = document.createElement('div');\n        this.el.style.position = 'absolute';\n        this.el.style.zIndex = '-1';\n\n        this.trigger('renderconnection', { \n            el: this.el, \n            connection: this.connection, \n            points: this.getPoints()\n        });\n    }\n\n    getPoints() {\n        const [x1, y1] = this.outputNode.getSocketPosition(this.connection.output);\n        const [x2, y2] = this.inputNode.getSocketPosition(this.connection.input);\n\n        return [x1, y1, x2, y2];\n    }\n\n    update() {\n        this.trigger('updateconnection', { \n            el: this.el, \n            connection: this.connection, \n            points: this.getPoints()\n        });\n    }\n}","import { Area } from './area';\nimport { Connection } from '../connection';\nimport { Emitter } from '../core/emitter';\nimport { Node } from '../node';\nimport { Connection as ViewConnection } from './connection';\nimport { Node as ViewNode } from './node';\n\nexport class EditorView extends Emitter {\n\n    constructor(container: HTMLElement, components: Object, emitter: Emitter) {\n        super(emitter);\n\n        this.container = container;\n        this.components = components;\n\n        this.container.style.overflow = 'hidden';\n\n        this.nodes = new Map();\n        this.connections = new Map();\n\n        this.container.addEventListener('click', this.click.bind(this));\n        this.container.addEventListener('contextmenu', e => this.trigger('contextmenu', { e, view: this }));\n        window.addEventListener('resize', this.resize.bind(this));\n\n        this.on('nodetranslated', this.updateConnections.bind(this));\n            \n        this.area = new Area(container, this);\n        this.container.appendChild(this.area.el);\n    }\n\n    addNode(node: Node) {\n        const nodeView = new ViewNode(node, this.components.get(node.name), this);\n\n        this.nodes.set(node, nodeView);\n        this.area.appendChild(nodeView.el);\n    }\n\n    removeNode(node: Node) {\n        const nodeView = this.nodes.get(node);\n\n        this.nodes.delete(node);\n        this.area.removeChild(nodeView.el);\n    }\n\n    addConnection(connection: Connection) {\n        const viewInput = this.nodes.get(connection.input.node);\n        const viewOutput = this.nodes.get(connection.output.node);\n        const connView = new ViewConnection(connection, viewInput, viewOutput, this);\n\n        this.connections.set(connection, connView);\n        this.area.appendChild(connView.el);\n    }\n\n    removeConnection(connection: Connection) {\n        const connView = this.connections.get(connection);\n\n        this.connections.delete(connection);\n        this.area.removeChild(connView.el);\n    }\n\n    updateConnections({ node }) {\n        node.getConnections().map(conn => {\n            this.connections.get(conn).update();\n        });\n    }\n\n    resize() {\n        const { container } = this;\n        const width = container.parentElement.clientWidth;\n        const height = container.parentElement.clientHeight;\n\n        container.style.width = width + 'px';\n        container.style.height = height + 'px';\n    }\n\n    click(e) {\n        const container = this.container;\n        \n        if (container !== e.target) return;\n        if (!this.trigger('click', { e, container })) return;\n    }\n}\n","import { Node } from './node';\n\nexport class Selected {\n\n    constructor() {\n        this.list = [];\n    }\n\n    add(item: Node, accumulate = false) {\n        if (!accumulate)\n            this.list = [item]; \n        else if (!this.contains(item))\n            this.list.push(item);   \n    }\n\n    clear() {\n        this.list = [];\n    }\n\n    remove(item) {\n        this.list.splice(this.list.indexOf(item), 1);\n    }\n\n    contains(item) {\n        return this.list.indexOf(item) !== -1;\n    }\n\n    each(callback) {\n        this.list.forEach(callback);\n    }\n}","import { Component } from './component';\nimport { Connection } from './connection';\nimport { Context } from './core/context';\nimport { EditorEvents } from './events';\nimport { EditorView } from './view/index';\nimport { Input } from './input';\nimport { Node } from './node';\nimport { Output } from './output';\nimport { Selected } from './selected';\nimport { Validator } from './core/validator';\n\nexport class NodeEditor extends Context {\n\n    constructor(id: string, container: HTMLElement) {\n        super(id, new EditorEvents());\n        \n        this.nodes = [];\n        this.components = new Map();\n\n        this.selected = new Selected();\n        this.view = new EditorView(container, this.components, this);\n\n        window.addEventListener('keydown', e => this.trigger('keydown', e));\n        window.addEventListener('keyup', e => this.trigger('keyup', e));\n        this.on('selectnode', ({ node, accumulate }) => this.selectNode(node, accumulate));\n        this.on('nodeselected', () => this.selected.each(n => this.view.nodes.get(n).onStart()));\n        this.on('translatenode', ({ dx, dy }) => this.selected.each(n => this.view.nodes.get(n).onDrag(dx, dy)));\n    }\n\n    addNode(node: Node) {\n        if (!this.trigger('nodecreate', node)) return;\n\n        this.nodes.push(node);\n        this.view.addNode(node);\n        \n        this.trigger('nodecreated', node);\n    }\n\n    removeNode(node: Node) {\n        if (!this.trigger('noderemove', node)) return;\n\n        node.getConnections().forEach(c => this.removeConnection(c));\n\n        this.nodes.splice(this.nodes.indexOf(node), 1);\n        this.view.removeNode(node);\n\n        this.trigger('noderemoved', node);\n    }\n\n    connect(output: Output, input: Input, data = {}) {\n        if (!this.trigger('connectioncreate', { output, input })) return;\n\n        try {\n            const connection = output.connectTo(input);\n\n            connection.data = data;\n            this.view.addConnection(connection);\n\n            this.trigger('connectioncreated', connection);\n        } catch (e) {\n            this.trigger('warn', e)\n        }\n    }\n\n    removeConnection(connection: Connection) {\n        if (!this.trigger('connectionremove', connection)) return;\n            \n        this.view.removeConnection(connection);\n        connection.remove();\n\n        this.trigger('connectionremoved', connection);\n    }\n\n    selectNode(node: Node, accumulate: boolean = false) {\n        if (this.nodes.indexOf(node) === -1) \n            throw new Error('Node not exist in list');\n        \n        if (!this.trigger('nodeselect', node)) return;\n\n        this.selected.add(node, accumulate);\n        \n        this.trigger('nodeselected', node);\n    }\n\n    getComponent(name) {\n        const component = this.components.get(name);\n\n        if (!component)\n            throw `Component ${name} not found`;\n        \n        return component;\n    }\n\n    register(component: Component) {\n        component.editor = this;\n        this.components.set(component.name, component);\n        this.trigger('componentregister', component)\n    }\n\n    clear() {\n        [...this.nodes].map(node => this.removeNode(node));\n    }\n\n    toJSON() {\n        const data = { id: this.id, nodes: {} };\n        \n        this.nodes.forEach(node => data.nodes[node.id] = node.toJSON());\n        this.trigger('export', data);\n        return data;\n    }\n\n    beforeImport(json: Object) {\n        var checking = Validator.validate(this.id, json);\n        \n        if (!checking.success) {\n            this.trigger('warn', checking.msg);\n            return false;\n        }\n        \n        this.silent = true;\n        this.clear();\n        this.trigger('import', json);\n        return true;\n    }\n\n    afterImport() {\n        this.silent = false;\n        return true;\n    }\n\n    async fromJSON(json: Object) {\n        if (!this.beforeImport(json)) return false;\n        var nodes = {};\n\n        try {\n            await Promise.all(Object.keys(json.nodes).map(async id => {\n                var node = json.nodes[id];\n                var component = this.getComponent(node.name);\n\n                nodes[id] = await component.build(Node.fromJSON(node));\n                this.addNode(nodes[id]);\n            }));\n        \n            Object.keys(json.nodes).forEach(id => {\n                var jsonNode = json.nodes[id];\n                var node = nodes[id];\n                \n                Object.keys(jsonNode.outputs).forEach(key => {\n                    var outputJson = jsonNode.outputs[key];\n\n                    outputJson.connections.forEach(jsonConnection => {\n                        var nodeId = jsonConnection.node;\n                        var data = jsonConnection.data;\n                        var targetOutput = node.outputs.get(key);\n                        var targetInput = nodes[nodeId].inputs.get(jsonConnection.input);\n\n                        this.connect(targetOutput, targetInput, data);\n                    });\n                });\n\n            });\n        }\n        catch (e) {\n            this.trigger('warn', e);\n            return !this.afterImport();\n        } finally {\n            return this.afterImport();\n        }\n    }\n}\n","import { Component } from './component';\nimport { Control } from './control';\nimport { Emitter } from './core/emitter';\nimport { Engine } from './engine/index';\nimport { Input } from './input';\nimport { Node } from './node';\nimport { NodeEditor } from './editor';\nimport { Output } from './output';\nimport { Socket } from './socket';\n\nexport { Component } from './component';\nexport { Control } from './control';\nexport { Emitter } from './core/emitter';\nexport { Engine } from './engine/index';\nexport { Input } from './input';\nexport { Node } from './node';\nexport { NodeEditor } from './editor';\nexport { Output } from './output';\nexport { Socket } from './socket';\n\nexport default {\n    Component,\n    Control,\n    Emitter,\n    Engine,\n    Input,\n    Node,\n    NodeEditor,\n    Output,\n    Socket\n}"],"names":["Component","name","constructor","TypeError","data","engine","Control","key","Error","parent","Node","node","getNode","Connection","output","input","addConnection","removeConnection","IO","socket","multiConns","multipleConnections","connections","connection","splice","indexOf","map","Socket","compatible","push","includes","Input","title","control","length","hasConnection","c","id","Output","compatibleWith","some","item","incrementId","position","inputs","Map","outputs","controls","meta","set","delete","removeConnections","ios","values","reduce","arr","io","Array","from","obj","toJSON","latestId","json","Math","max","editor","builder","build","ComponentWorker","Events","handlers","warn","console","error","Emitter","events","silent","names","handler","split","forEach","params","r","e","isArray","Validator","isValidId","nodes","Object","test","msg","id1","id2","isValidData","success","Context","plugins","plugin","options","has","install","EngineEvents","componentregister","State","AVALIABLE","PROCESSED","ABORT","Engine","components","args","state","onAbort","register","component","trigger","message","abort","processDone","keys","a","b","nodesArr","findSelf","inputNodes","n","i","extractInputNodes","filter","Promise","ret","res","unlockPool","busy","outputData","conns","all","prevNode","processNode","connData","extractInputData","inputData","find","worker","lock","processWorker","unlock","nextNode","forwardProcess","assign","checking","validate","throwError","recurentNodes","detectRecursions","startNode","startId","processStart","copy","processStartNode","processUnreachable","EditorEvents","nodecreate","nodecreated","noderemove","noderemoved","connectioncreate","connectioncreated","connectionremove","connectionremoved","translatenode","nodetranslate","nodetranslated","nodedraged","selectnode","nodeselect","nodeselected","rendernode","rendersocket","rendercontrol","renderconnection","updateconnection","keydown","keyup","translate","translated","zoom","zoomed","click","mousemove","contextmenu","import","export","process","Drag","el","onTranslate","onStart","onDrag","pointerStart","initEvents","style","touchAction","addEventListener","down","bind","window","move","up","stopPropagation","pageX","pageY","preventDefault","x","y","delta","getBoundingClientRect","width","offsetWidth","Zoom","container","intensity","onzoom","distance","wheel","end","dblclick","rect","wheelDelta","deltaY","ox","left","clientX","oy","top","clientY","touches","x1","y1","x2","y2","sqrt","pow","cx","cy","Area","emitter","document","createElement","transform","k","mouse","transformOrigin","_startPosition","_zoom","onZoom","_drag","pointermove","update","t","dx","dy","source","d","appendChild","removeChild","type","offsetLeft","offsetTop","offsetHeight","sockets","onSelect","bindSocket","bindControl","ViewSocket","ViewControl","get","getPosition","accumulate","ctrlKey","prev","inputNode","outputNode","zIndex","points","getPoints","getSocketPosition","EditorView","overflow","view","resize","on","updateConnections","area","nodeView","ViewNode","viewInput","viewOutput","connView","ViewConnection","getConnections","conn","parentElement","clientWidth","height","clientHeight","target","Selected","list","contains","callback","NodeEditor","selected","selectNode","each","addNode","removeNode","connectTo","remove","add","clear","beforeImport","getComponent","fromJSON","jsonNode","outputJson","jsonConnection","nodeId","targetOutput","targetInput","connect","afterImport"],"mappings":"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"}