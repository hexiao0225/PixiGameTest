{"version":3,"file":"vue-render-plugin.debug.js","sources":["../src/filters.js","../src/mixin.js","../src/Socket.vue","../src/Node.vue","../src/index.js"],"sourcesContent":["import Vue from 'vue';\n\nVue.filter('kebab', (str) => {\n    const replace = s =>  s.toLowerCase().replace(/ /g, '-');\n\n    return Array.isArray(str) ?  str.map(replace) : replace(str);\n});","export default {\n    props: ['node', 'editor', 'bindSocket', 'bindControl'],\n    methods: {\n        inputs() {\n            return Array.from(this.node.inputs.values())\n        },\n        outputs() {\n            return Array.from(this.node.outputs.values())\n        },\n        controls() {\n            return Array.from(this.node.controls.values())\n        },\n        selected() {\n            return this.editor.selected.contains(this.node) ? 'selected' : '';\n        }\n    },\n    directives: {\n        socket: {\n            bind(el, binding, vnode) {\n                vnode.context.bindSocket(el, binding.arg, binding.value);\n            }\n        },\n        control: {\n            bind(el, binding, vnode) {\n                if (!binding.value) return;\n\n                vnode.context.bindControl(el, binding.value);\n            }\n        }\n    }\n}","<template lang=\"pug\">\n.socket(\n  :class=\"[type, socket.name] | kebab\",\n  :title=\"socket.name+'\\\\n'+socket.hint\"\n)\n</template>\n\n<script>\nexport default {\n  props: ['type', 'socket']\n}\n</script>\n\n<style lang=\"sass\" scoped>\n@import \"./vars\"\n\n.socket\n  display: inline-block\n  cursor: pointer\n  border: 1px solid white\n  border-radius: $socket-size/2.0\n  width: $socket-size\n  height: $socket-size\n  margin: $socket-margin\n  vertical-align: middle\n  background: $socket-color\n  z-index: 2\n  box-sizing: border-box\n  &:hover\n    border-width: 4px\n  &.multiple\n    border-color: yellow\n  &.output\n    margin-right: - $socket-size / 2\n  &.input\n    margin-left: - $socket-size / 2\n</style>\n","<template lang=\"pug\">\n.node(:class=\"[selected(), node.name] | kebab\")\n  .title {{node.name}}\n\n  // Outputs\n  .output(v-for='output in outputs()' :key=\"output.key\")\n    .output-title {{output.name}}\n    Socket(v-socket:output=\"output\", type=\"output\", :socket=\"output.socket\")\n\n  // Controls\n  .control(\n    v-for='control in controls()',\n    v-control=\"control\"\n  )\n\n  // Inputs\n  .input(v-for='input in inputs()' :key=\"input.key\")\n    Socket(v-socket:input=\"input\", type=\"input\", :socket=\"input.socket\")\n    .input-title(v-show='!input.showControl()') {{input.name}}\n    .input-control(\n      v-show='input.showControl()'\n      v-control=\"input.control\"\n    )\n</template>\n\n<script>\nimport mixin from './mixin';\nimport Socket from './Socket.vue';\n\nexport default {\n  mixins: [mixin],\n  components: {\n    Socket\n  }\n}\n</script>\n\n<style lang=\"sass\" scoped>\n@import \"./vars\"\n\n.node\n  background: $node-color\n  border: 2px solid #4e58bf\n  border-radius: 10px\n  cursor: pointer\n  min-width: $node-width\n  height: auto\n  padding-bottom: 6px\n  box-sizing: content-box\n  position: relative\n  user-select: none\n  &:hover\n    background: lighten($node-color,4%)\n  &.selected\n    background: $node-color-selected\n    border-color: #e3c000\n  .title\n    color: white\n    font-family: sans-serif\n    font-size: 18px\n    padding: 8px\n  .output\n    text-align: right\n  .input\n    text-align: left\n  .input-title,.output-title\n    vertical-align: middle\n    color: white\n    display: inline-block\n    font-family: sans-serif\n    font-size: 14px\n    margin: $socket-margin\n    line-height: $socket-size\n  .input-control\n    z-index: 1\n    width: calc(100% - #{$socket-size + 2*$socket-margin})\n    vertical-align: middle\n    display: inline-block\n  .control\n    padding: $socket-margin $socket-size/2 + $socket-margin\n</style>","import './filters';\nimport Node from './Node.vue';\nimport Socket from './Socket.vue';\nimport Vue from 'vue';\nimport mixin from './mixin';\n\nfunction createVue(el, vueComponent, vueProps) {\n    const app = new Vue({\n        render: h => h(vueComponent, { props: vueProps })\n    });\n\n    const nodeEl = document.createElement('div');\n\n    el.appendChild(nodeEl);\n    app.$mount(nodeEl);\n    \n    return app;\n}\n\nfunction createNode(editor, { el, node, component, bindSocket, bindControl }) {\n    const vueComponent = component.component || Node;\n    const vueProps = { ...component.props, node, editor, bindSocket, bindControl };\n    const app = createVue(el, vueComponent, vueProps);\n\n    node.vueContext = app.$children[0];\n\n    return app;\n}\n\nfunction createControl(editor, { el, control }) {\n    const vueComponent = control.component;\n    const vueProps = { ...control.props, getData: control.getData.bind(control), putData: control.putData.bind(control) };\n    const app = createVue(el, vueComponent, vueProps);\n\n    control.vueContext = app.$children[0];\n\n    return app;\n}\n\nconst update = (entity) => {\n    if (entity.vueContext)\n        entity.vueContext.$forceUpdate();\n}\n\nfunction install(editor, params) {\n    editor.on('rendernode', ({ el, node, component, bindSocket, bindControl }) => {\n        if (component.render && component.render !== 'vue') return;\n        node._vue = createNode(editor, { el, node, component, bindSocket, bindControl });\n        node.update = () => update(node);\n    });\n\n    editor.on('rendercontrol', ({ el, control }) => {\n        if (control.render && control.render !== 'vue') return;\n        control._vue = createControl(editor, { el, control });\n        control.update = () => update(control)\n    });\n\n    editor.on('connectioncreated connectionremoved', connection => {\n        update(connection.output.node)\n        update(connection.input.node)\n    });\n\n    editor.on('nodeselected', () => {\n        editor.nodes.map(update);\n    });\n}\n\nexport default {\n    name: 'vue-render',\n    install,\n    mixin,\n    Node,\n    Socket\n}\n"],"names":["Vue","filter","str","replace","s","toLowerCase","Array","isArray","map","props","methods","inputs","from","node","values","outputs","controls","selected","editor","contains","directives","socket","bind","el","binding","vnode","context","bindSocket","arg","value","control","bindControl","createVue","vueComponent","vueProps","app","render","h","nodeEl","document","createElement","appendChild","$mount","createNode","component","Node","vueContext","$children","createControl","getData","putData","update","entity","$forceUpdate","install","params","on","_vue","connection","output","input","nodes","name","mixin","Socket"],"mappings":"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"}